(self.webpackChunkflowervalley=self.webpackChunkflowervalley||[]).push([[483],{6483:(ne,D,E)=>{"use strict";function U(u,m,d,f,h,v,p){try{var P=u[v](p),C=P.value}catch(R){return void d(R)}P.done?m(C):Promise.resolve(C).then(f,h)}function x(u){return function(){var m=this,d=arguments;return new Promise(function(f,h){var v=u.apply(m,d);function p(C){U(v,f,h,p,P,"next",C)}function P(C){U(v,f,h,p,P,"throw",C)}p(void 0)})}}E.d(D,{o:()=>te});var c=E(5e3),B=E(3659),Z=E.n(B),I=E(7582),O=(()=>{return(u=O||(O={}))[u.Up=1]="Up",u[u.Down=3]="Down",u[u.Right=6]="Right",u[u.Left=8]="Left",u[u.UpMirrored=2]="UpMirrored",u[u.DownMirrored=4]="DownMirrored",u[u.LeftMirrored=5]="LeftMirrored",u[u.RightMirrored=7]="RightMirrored",u[u.Default=0]="Default",u[u.NotJpeg=-1]="NotJpeg",u[u.NotDefined=-2]="NotDefined",O;var u})();class M{}M.getOrientation=u=>new Promise((m,d)=>{try{const f=new FileReader;f.onload=()=>{const h=new DataView(f.result);if(!h.byteLength||65496!==h.getUint16(0,!1))return m(O.NotDefined);const v=h.byteLength;let p=2;for(;p<v;){const P=h.getUint16(p,!1);if(p+=2,65505===P){if(1165519206!==h.getUint32(p+=2,!1))return m(O.NotJpeg);const C=18761===h.getUint16(p+=6,!1);p+=h.getUint32(p+4,C);const R=h.getUint16(p,C);p+=2;for(let e=0;e<R;e++)if(274===h.getUint16(p+12*e,C))return m(h.getUint16(p+12*e+8,C))}else{if(65280!=(65280&P))break;p+=h.getUint16(p,!1)}}return m(O.NotJpeg)},f.readAsArrayBuffer(u)}catch(f){return d(O.Default)}}),M.uploadFile=(u,m=!0,d=!1)=>new Promise(function(f,h){const v=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),p=/iPad|iPhone|iPod/i.test(navigator.userAgent);Promise.resolve(v||p).then(P=>P?M.generateUploadInputNative(window.document,m,d):M.generateUploadInputRenderer(u,m,d)).then(P=>{const C=P?Array.from(P):[],R=C.map(r=>M.getOrientation(r)),e=C.map(r=>M.fileToDataURL(r));let t=[];Promise.all(R).then(r=>(t=r,Promise.all(e))).then(r=>{const o=r.map((l,s)=>({image:l.dataUrl,orientation:t[s],fileName:l.fileName}));f(m?o:o[0])})}).catch(P=>h(P))}),M.fileToDataURL=u=>new Promise((m,d)=>{const f=new FileReader;f.onload=h=>{m({dataUrl:h.target.result,fileName:u.name})};try{f.readAsDataURL(u)}catch(h){d(`ngx-image-compress - probably no file have been selected: ${h}`)}}),M.generateUploadInputRenderer=(u,m=!0,d=!1)=>{let f=!1;return new Promise((h,v)=>{const p=u.createElement("input");u.setStyle(p,"display","none"),u.setProperty(p,"type","file"),u.setProperty(p,"accept","image/*"),m&&u.setProperty(p,"multiple","true"),u.listen(p,"click",P=>{P.target.value=""}),u.listen(p,"change",P=>{f=!0,h(P.target.files)}),d&&window.addEventListener("focus",()=>{setTimeout(()=>{f||v(new Error("file upload on blur - no file selected"))},300)},{once:!0}),p.click()})},M.generateUploadInputNative=(u,m=!0,d=!1)=>{let f=!1;return new Promise((h,v)=>{const p=u.createElement("input");p.id="upload-input"+new Date,p.style.display="none",p.setAttribute("type","file"),p.setAttribute("accept","image/*"),m&&p.setAttribute("multiple","true"),u.body.appendChild(p),p.addEventListener("change",()=>{f=!0,h(p.files),u.body.removeChild(u.getElementById(p.id))},{once:!0}),d&&window.addEventListener("focus",()=>{setTimeout(()=>{!f&&u.getElementById(p.id)&&(v(new Error("file upload on blur - no file selected")),u.body.removeChild(u.getElementById(p.id)))},300)},{once:!0}),p.click()})},M.compress=(u,m,d,f=50,h=50,v=0,p=0)=>new Promise(function(P,C){h/=100,f/=100;const R=new Image;R.onload=()=>{const e=d.createElement("canvas"),t=e.getContext("2d");if(!t)return C("No canvas context available");let r=R.naturalWidth,o=R.naturalHeight;if(!CSS.supports("image-orientation","from-image")&&(m===O.Right||m===O.Left)){const n=r;r=o,o=n}f=Math.min(f,v?v/r:1,p?p/o:1),e.width=r*f,e.height=o*f;const g=Math.PI/180;CSS.supports("image-orientation","from-image")||m===O.Up?t.drawImage(R,0,0,e.width,e.height):m===O.Right?(t.save(),t.rotate(90*g),t.translate(0,-e.width),t.drawImage(R,0,0,e.height,e.width),t.restore()):m===O.Left?(t.save(),t.rotate(-90*g),t.translate(-e.width,0),t.drawImage(R,0,0,e.height,e.width),t.restore()):m===O.Down?(t.save(),t.rotate(180*g),t.translate(-e.width,-e.height),t.drawImage(R,0,0,e.width,e.height),t.restore()):t.drawImage(R,0,0,e.width,e.height);const j=u.substr(5,u.split(";")[0].length-5),L=e.toDataURL(j,h);P(L)},R.onerror=e=>C(e),R.src=u}),M.byteCount=u=>encodeURI(u).split(/%..|./).length-1,M.getImageMaxSize=(u,m,d,f=!1)=>(0,I.mG)(void 0,void 0,void 0,function*(){const v=C=>(C/1024/1024).toFixed(2);m&&console.debug("NgxImageCompress - Opening upload window");let P,p=yield M.uploadFile(d,!1,f);for(let C=0;C<10;C++){const R=M.byteCount(p.image);P=yield M.compress(p.image,p.orientation,d,50,100);const e=M.byteCount(P);if(console.debug("NgxImageCompress -","Compression from",v(R),"MB to",v(e),"MB"),e>=R)throw 0===C?(m&&console.debug("NgxImageCompress -","File can't be reduced at all - returning the original",v(R),"MB large"),p.image):(m&&console.debug("NgxImageCompress -","File can't be reduced more - returning the best we can, which is ",v(R),"MB large"),p.image);if(e<1024*u*1024)return m&&console.debug("NgxImageCompress -","Here your file",v(e),"MB large"),P;if(9===C)throw m&&console.debug("NgxImageCompress -","File can't reach the desired size after",10,"tries. Returning file ",v(R),"MB large"),p.image;m&&console.debug("NgxImageCompress -","Reached",v(e),"MB large. Trying another time after",C+1,"times"),p.image=P}throw m&&console.debug("NgxImageCompress - Unexpected error"),""});let k=(()=>{class u{constructor(d){this.DOC_ORIENTATION=O,this.render=d.createRenderer(null,null)}byteCount(d){return M.byteCount(d)}getOrientation(d){return M.getOrientation(d)}uploadFile(){return M.uploadFile(this.render,!1)}uploadMultipleFiles(){return M.uploadFile(this.render,!0)}uploadFileOrReject(){return M.uploadFile(this.render,!1,!0)}uploadMultipleFilesOrReject(){return M.uploadFile(this.render,!0,!0)}compressFile(d,f,h=50,v=50,p=0,P=0){return M.compress(d,f,this.render,h,v,p,P)}uploadAndGetImageWithMaxSize(d=1,f=!1,h=!1){return M.getImageMaxSize(d,f,this.render,h)}}return u.\u0275fac=function(d){return new(d||u)(c.LFG(c.FYo))},u.\u0275prov=c.Yz7({token:u,factory:u.\u0275fac,providedIn:"root"}),u})();var Y=E(6805),V=E(2340),W=E(2260),X=E(1208),T=E(3075),z=E(27),H=E(9808),$=E(9047),K=E(8850),J=E(845);const _=["fileUpload"];function N(u,m){1&u&&(c.TgZ(0,"div",7),c._UZ(1,"flower-valley-loader",8),c.qZA())}function q(u,m){if(1&u){const d=c.EpF();c.TgZ(0,"div",11),c._UZ(1,"p-image",12),c.TgZ(2,"p-button",13),c.NdJ("onClick",function(){const v=c.CHM(d).index;return c.oxw(2).removeImage(v)}),c.qZA()()}if(2&u){const d=m.$implicit;c.xp6(1),c.Q6J("src",d)}}function ee(u,m){if(1&u&&(c.TgZ(0,"div",9),c.YNc(1,q,3,1,"div",10),c.qZA()),2&u){const d=c.oxw();c.xp6(1),c.Q6J("ngForOf",d.localCompressedUrl)}}let te=(()=>{class u{constructor(d,f){this.imageCompress=d,this.staticData=f,this.multi=!0,this.label="\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u044f",this.showOnlyButton=!1,this.autoUpload=!1,this.uploaded=new c.vpe,this.localUrl=[],this.localCompressedUrl=[],this.compressedFiles=[],this.isWatermark=!1,this.isUploadingProcess=!1,this.initialFiles=[]}uploadFiles(d){var f=this;return x(function*(){var h;f.initialFiles=d,d.map(v=>{f.genLocalUrl(v)}),null===(h=f.fileUpload)||void 0===h||h.clear()})()}setWatermark(d,f){return Z()([d,f||"assets/images/logo.png"]).blob((h,v)=>{let p=h.getContext("2d");p.save(),p.globalAlpha=.7;const P=.25*h.height;return p.drawImage(v,10,10,P,.8237*P),p.restore(),h})}removeImage(d){this.localUrl.splice(d,1),this.localCompressedUrl.splice(d,1),this.compressedFiles.splice(d,1),this.uploaded.emit(this.compressedFiles)}genLocalUrl(d){this.isUploadingProcess=!0;const f=d.name,h=new FileReader;h.onload=v=>{this.localUrl=!this.multi&&this.localUrl.length?[v.target.result]:this.localUrl.concat(v.target.result),this.compressFile(v.target.result,f)},h.readAsDataURL(d)}compressFile(d,f){var h=this;return x(function*(){h.imageCompress.compressFile(d,-1,50,100).then(function(){var p=x(function*(P){let C=new File([h.dataURItoBlob(P.split(",")[1])],f);if(h.isWatermark){const R=h.staticData.getLogo(),{img:e}=yield function G(u,m){const d="object"==typeof m;return new Promise((f,h)=>{let p,v=!1;u.subscribe({next:P=>{p=P,v=!0},error:h,complete:()=>{v?f(p):d?f(m.defaultValue):h(new Y.K)}})})}(R),t=yield V.N.production?h.setWatermark(C,e):h.setWatermark(C),r=new FileReader;r.onload=o=>{C=new File([t],f),h.uploadEmit(C,o.target.result)},r.readAsDataURL(t)}else h.uploadEmit(C,P)});return function(P){return p.apply(this,arguments)}}())})()}uploadEmit(d,f){!this.multi&&this.localUrl.length?(this.localCompressedUrl=[f],this.compressedFiles=[d]):(this.localCompressedUrl=this.localCompressedUrl.concat(f),this.compressedFiles=this.compressedFiles.concat(d)),this.autoUpload?this.compressedFiles.length===this.initialFiles.length&&(this.isUploadingProcess=!1,this.uploaded.emit(this.compressedFiles),this.localUrl=[],this.localCompressedUrl=[],this.compressedFiles=[]):(this.isUploadingProcess=!1,this.uploaded.emit(this.compressedFiles))}dataURItoBlob(d){const f=window.atob(d),h=new ArrayBuffer(f.length),v=new Uint8Array(h);for(let p=0;p<f.length;p++)v[p]=f.charCodeAt(p);return new Blob([v],{type:"image/jpeg"})}}return u.\u0275fac=function(d){return new(d||u)(c.Y36(k),c.Y36(W.v))},u.\u0275cmp=c.Xpm({type:u,selectors:[["flower-valley-files-upload"]],viewQuery:function(d,f){if(1&d&&c.Gf(_,5),2&d){let h;c.iGM(h=c.CRH())&&(f.fileUpload=h.first)}},inputs:{multi:"multi",label:"label",showOnlyButton:"showOnlyButton",autoUpload:"autoUpload"},outputs:{uploaded:"uploaded"},features:[c._Bn([k])],decls:8,vars:9,consts:[[1,"p-field-checkbox","mb-2"],["inputId","isWatermark",3,"ngModel","binary","ngModelChange"],["for","isWatermark"],["styleClass","mb-2","mode","basic",3,"customUpload","disabled","chooseLabel","multiple","auto","uploadHandler"],["fileUpload",""],["class","loader",4,"ngIf"],["class","grid mt-2",4,"ngIf"],[1,"loader"],["appearance","small"],[1,"grid","mt-2"],["class","img col-3",4,"ngFor","ngForOf"],[1,"img","col-3"],["styleClass","w-12","imageClass","w-12",3,"src"],["styleClass","p-button-danger","icon","pi pi-trash",3,"onClick"]],template:function(d,f){1&d&&(c.TgZ(0,"div",0)(1,"p-checkbox",1),c.NdJ("ngModelChange",function(v){return f.isWatermark=v}),c.qZA(),c.TgZ(2,"label",2),c._uU(3,"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0432\u043e\u0434\u044f\u043d\u043e\u0439 \u0437\u043d\u0430\u043a"),c.qZA()(),c.TgZ(4,"p-fileUpload",3,4),c.NdJ("uploadHandler",function(v){return f.uploadFiles(v.files)}),c.qZA(),c.YNc(6,N,2,0,"div",5),c.YNc(7,ee,2,1,"div",6)),2&d&&(c.xp6(1),c.Q6J("ngModel",f.isWatermark)("binary",!0),c.xp6(3),c.Q6J("customUpload",!0)("disabled",f.isUploadingProcess)("chooseLabel",f.label)("multiple",f.multi)("auto",!0),c.xp6(2),c.Q6J("ngIf",f.isUploadingProcess),c.xp6(1),c.Q6J("ngIf",!f.showOnlyButton&&f.localCompressedUrl.length))},directives:[X.XZ,T.JJ,T.On,z.p,H.O5,$.R,H.sg,K.E,J.zx],styles:[".loader[_ngcontent-%COMP%]{max-width:300px}.img[_ngcontent-%COMP%]{position:relative}.img[_ngcontent-%COMP%]   p-button[_ngcontent-%COMP%]{position:absolute;top:0;left:0}.p-field-checkbox[_ngcontent-%COMP%]{margin-bottom:10px;display:flex;align-items:center}.p-field-checkbox[_ngcontent-%COMP%]     .p-checkbox-box{box-shadow:none}.p-field-checkbox[_ngcontent-%COMP%]     .p-checkbox .p-checkbox-box.p-highlight{background-color:#8fb600;border-color:#8fb600}.p-field-checkbox[_ngcontent-%COMP%]     .p-checkbox:not(.p-checkbox-disabled) .p-checkbox-box:hover, .p-field-checkbox[_ngcontent-%COMP%]     .p-checkbox:not(.p-checkbox-disabled) .p-checkbox-box.p-focus{border-color:#8fb600}.p-field-checkbox[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin-left:10px;font-weight:500;font-size:16px;line-height:100%}.p-field-checkbox[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:hover{cursor:pointer}"]}),u})()},3659:ne=>{window,ne.exports=function(D){var E={};function U(x){if(E[x])return E[x].exports;var c=E[x]={i:x,l:!1,exports:{}};return D[x].call(c.exports,c,c.exports,U),c.l=!0,c.exports}return U.m=D,U.c=E,U.d=function(x,c,B){U.o(x,c)||Object.defineProperty(x,c,{enumerable:!0,get:B})},U.r=function(x){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(x,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(x,"__esModule",{value:!0})},U.t=function(x,c){if(1&c&&(x=U(x)),8&c||4&c&&"object"==typeof x&&x&&x.__esModule)return x;var B=Object.create(null);if(U.r(B),Object.defineProperty(B,"default",{enumerable:!0,value:x}),2&c&&"string"!=typeof x)for(var Z in x)U.d(B,Z,function(I){return x[I]}.bind(null,Z));return B},U.n=function(x){var c=x&&x.__esModule?function(){return x.default}:function(){return x};return U.d(c,"a",c),c},U.o=function(x,c){return Object.prototype.hasOwnProperty.call(x,c)},U.p="",U(U.s=0)}([function(D,E,U){D.exports=U(1).default},function(D,E,U){"use strict";U.r(E);var x={};U.r(x),U.d(x,"atPos",function(){return _}),U.d(x,"lowerRight",function(){return N}),U.d(x,"upperRight",function(){return q}),U.d(x,"lowerLeft",function(){return ee}),U.d(x,"upperLeft",function(){return te}),U.d(x,"center",function(){return u});var c={};function Z(n){return n}function I(n){return(I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(i){return typeof i}:function(i){return i&&"function"==typeof Symbol&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i})(n)}function Q(n){return"string"===I(n)?k:n instanceof Image?Z:Y}function M(n,a){for(var i=[],b=0;b<n.length;b++){var w=n[b],F=Q(w)(w,a);i.push(F)}return Promise.all(i)}function k(n,a){var i=new Image;return"function"==typeof a&&a(i),new Promise(function(b){i.onload=function(){return b(i)},i.src=n})}function Y(n){var a=new FileReader;return new Promise(function(i){var b=new Image;a.onloadend=function(){return function O(n,a,i){n.onload=function(){return i(n)},n.src=a}(b,a.result,i)},a.readAsDataURL(n)})}function G(n,a){var i=new Image;return"function"==typeof a&&(i.onload=a),i.src=n,i}function X(n,a){return n.map(function(i){return function W(n,a){return function V(n,a){var i=a.getContext("2d");return a.width=n.width,a.height=n.height,i.drawImage(n,0,0),a}(n,a.pop())}(i,a)})}U.r(c),U.d(c,"atPos",function(){return m}),U.d(c,"lowerRight",function(){return d}),U.d(c,"lowerLeft",function(){return f}),U.d(c,"upperRight",function(){return h}),U.d(c,"upperLeft",function(){return v}),U.d(c,"center",function(){return p});var z=/^data:([^;]+);base64,(.*)$/;function $(n){return window.atob(n)}function K(n){for(var a=n.length,i=new Uint8Array(a),b=0;b<a;b++)i[b]=n.charCodeAt(b);return i}var J=function B(){for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return function(b){return a.reduce(function(w,y){return y.call(null,w)},b)}}(function H(n){return z.exec(n).slice(1)},function(n){return[$(n[1]),n[0]]},function(n){return new Blob([K(n[0])],{type:n[1]})});function _(n,a,i){return i||(i=1),function(b,w){var y=b.getContext("2d");return y.save(),y.globalAlpha=i,y.drawImage(w,n(b,w),a(b,w)),y.restore(),b}}function N(n){return _(function(a,i){return a.width-(i.width+10)},function(a,i){return a.height-(i.height+10)},n)}function q(n){return _(function(a,i){return a.width-(i.width+10)},function(a,i){return 10},n)}function ee(n){return _(function(a,i){return 10},function(a,i){return a.height-(i.height+10)},n)}function te(n){return _(function(a,i){return 10},function(a,i){return 10},n)}function u(n){return _(function(a,i){return(a.width-i.width)/2},function(a,i){return(a.height-i.height)/2},n)}function m(n,a,i,b,w,y){return y||(y=1),function(F){var S=F.getContext("2d");S.save(),S.globalAlpha=y,S.fillStyle=w,S.font=b;var A=S.measureText(i);return S.fillText(i,n(F,A,S),a(F,A,S)),S.restore(),F}}function d(n,a,i,b,w){return m(function(y,F){return y.width-(F.width+10)},function(y){return w||y.height-10},n,a,i,b)}function f(n,a,i,b,w){return m(function(){return 10},function(y){return w||y.height-10},n,a,i,b)}function h(n,a,i,b,w){return m(function(y,F){return y.width-(F.width+10)},function(){return w||20},n,a,i,b)}function v(n,a,i,b,w){return m(function(){return 10},function(){return w||20},n,a,i,b)}function p(n,a,i,b,w){return m(function(y,F,S){return S.textAlign="center",y.width/2},function(y,F,S){return S.textBaseline="middle",y.height/2},n,a,i,b)}var P=x,C=c;function R(n,a){return{canvas:n.apply(null,a),sources:a}}function e(n,a){return Object.keys(a).forEach(function(b){return n[b]=a[b]}),n}var l=function r(){var n=[];return{pop:function(){return 0===this.length&&n.push(document.createElement("canvas")),n.pop()},get length(){return n.length},release:function(i){i.getContext("2d").clearRect(0,0,i.width,i.height),n.push(i)},clear:function(){n.splice(0,n.length)},get elements(){return n}}}();U.d(E,"default",function(){return L});var s={init:function(){},type:"image/png",encoderOptions:.92};function g(n){return e(function t(n){return e({},n)}(s),n)}function j(n,a,i){var w=n.sources,y=function T(n){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{type:"image/png",encoderOptions:.92};return n.toDataURL(a.type,a.encoderOptions)}(n.canvas,i);return w.forEach(a.release),y}function L(n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,b=g(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{});return i||(i=M(n,b.init)),{dataUrl:function(y){var F=this.then(function(S){return X(S,l)}).then(function(S){return R(y,S)}).then(function(S){return j(S,l,{type:b.type,encoderOptions:b.encoderOptions})});return L(n,b,F)},load:function(y,F){var S=this.then(function(A){return M([A].concat(y),F)});return L(y,b,S)},render:function(){var y=this.then(function(F){return M([F])});return L(n,b,y)},blob:function(y){var F=this.dataUrl(y).then(J);return L(n,b,F)},image:function(y){var F=this.dataUrl(y).then(G);return L(n,b,F)},then:function(){for(var y=arguments.length,F=new Array(y),S=0;S<y;S++)F[S]=arguments[S];return i.then.apply(i,F)}}}L.image=P,L.text=C,L.destroy=function(){return l.clear()}}])},7582:(ne,D,E)=>{"use strict";function Z(e,t,r,o){var g,l=arguments.length,s=l<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var j=e.length-1;j>=0;j--)(g=e[j])&&(s=(l<3?g(s):l>3?g(t,r,s):g(t,r))||s);return l>3&&s&&Object.defineProperty(t,r,s),s}function G(e,t,r,o){return new(r||(r=Promise))(function(s,g){function j(a){try{n(o.next(a))}catch(i){g(i)}}function L(a){try{n(o.throw(a))}catch(i){g(i)}}function n(a){a.done?s(a.value):function l(s){return s instanceof r?s:new r(function(g){g(s)})}(a.value).then(j,L)}n((o=o.apply(e,t||[])).next())})}E.d(D,{gn:()=>Z,mG:()=>G}),"function"==typeof SuppressedError&&SuppressedError}}]);